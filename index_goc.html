<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Digital Tools and Code Store - Cửa hàng công cụ và mã nguồn số</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
    :root {
        --primary-color: #3498db;
        --secondary-color: #2980b9;
        --accent-color: #1abc9c;
        --light-color: #ecf0f1;
        --dark-color: #2c3e50;
        --success-color: #2ecc71;
        --warning-color: #f39c12;
        --danger-color: #e74c3c;
    }
    
    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }
    
    body {
        background-color: #f9f9f9;
        color: #333;
        line-height: 1.6;
    }
    
    .container {
        width: 100%;
        max-width: 1200px;
        margin: 0 auto;
        padding: 0 20px;
    }
    
    /* Header Styles */
    header {
        background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
        color: white;
        padding: 15px 0;
        position: sticky;
        top: 0;
        z-index: 1000;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    }
    
    .header-content {
        display: flex;
        justify-content: space-between;
        align-items: center;
    }
    
    .logo {
        display: flex;
        align-items: center;
        gap: 10px;
    }
    
    .logo h1 {
        font-size: 1.8rem;
        font-weight: 700;
    }
    
    .logo i {
        font-size: 2rem;
        color: white;
    }
    
    nav ul {
        display: flex;
        list-style: none;
        gap: 25px;
    }
    
    nav a {
        color: white;
        text-decoration: none;
        font-weight: 500;
        transition: all 0.3s ease;
        padding: 5px 10px;
        border-radius: 4px;
    }
    
    nav a:hover {
        background-color: rgba(255, 255, 255, 0.2);
    }
    
    .auth-buttons {
        display: flex;
        gap: 15px;
    }
    
    .btn {
        padding: 10px 20px;
        border-radius: 50px;
        border: none;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        gap: 8px;
    }
    
    .btn-primary {
        background-color: white;
        color: var(--primary-color);
    }
    
    .btn-primary:hover {
        background-color: #f1f1f1;
        transform: translateY(-2px);
    }
    
    .btn-outline {
        background-color: transparent;
        border: 2px solid white;
        color: white;
    }
    
    .btn-outline:hover {
        background-color: white;
        color: var(--primary-color);
        transform: translateY(-2px);
    }
    
    /* Mobile menu */
    .menu-toggle {
        display: none;
        flex-direction: column;
        justify-content: space-around;
        width: 30px;
        height: 25px;
        background: transparent;
        border: none;
        cursor: pointer;
        padding: 0;
    }
    
    .menu-toggle span {
        width: 100%;
        height: 3px;
        background-color: white;
        border-radius: 5px;
        transition: all 0.3s ease;
    }
    
    /* Hero Section */
    .hero {
        background: linear-gradient(rgba(52, 152, 219, 0.8), rgba(41, 128, 185, 0.9)), url('https://images.unsplash.com/photo-1460925895917-afdab827c52f?ixlib=rb-4.0.3&auto=format&fit=crop&w=1415&q=80');
        background-size: cover;
        background-position: center;
        color: white;
        padding: 100px 0;
        text-align: center;
    }
    
    .hero-content {
        max-width: 800px;
        margin: 0 auto;
    }
    
    .hero h2 {
        font-size: 3rem;
        margin-bottom: 20px;
        animation: fadeInDown 1s ease;
    }
    
    .hero p {
        font-size: 1.2rem;
        margin-bottom: 30px;
        animation: fadeInUp 1s ease;
    }
    
    .hero-buttons {
        display: flex;
        justify-content: center;
        gap: 20px;
        animation: fadeIn 1.5s ease;
    }
    
    /* Features Section */
    .features {
        padding: 80px 0;
        background-color: white;
    }
    
    .section-title {
        text-align: center;
        margin-bottom: 50px;
        color: var(--dark-color);
    }
    
    .section-title h2 {
        font-size: 2.5rem;
        margin-bottom: 15px;
        color: var(--primary-color);
    }
    
    .section-title p {
        font-size: 1.1rem;
        color: #777;
        max-width: 700px;
        margin: 0 auto;
    }
    
    .features-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 30px;
    }
    
    .feature-card {
        background-color: var(--light-color);
        border-radius: 10px;
        padding: 30px;
        text-align: center;
        transition: all 0.3s ease;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
    }
    
    .feature-card:hover {
        transform: translateY(-10px);
        box-shadow: 0 15px 30px rgba(0, 0, 0, 0.1);
    }
    
    .feature-icon {
        font-size: 3rem;
        color: var(--primary-color);
        margin-bottom: 20px;
    }
    
    .feature-card h3 {
        font-size: 1.5rem;
        margin-bottom: 15px;
        color: var(--dark-color);
    }
    
    /* Products Section */
    .products {
        padding: 80px 0;
        background-color: #f5f7fa;
    }
    
    .products-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
        gap: 30px;
    }
    
    .product-card {
        background-color: white;
        border-radius: 10px;
        overflow: hidden;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
        transition: all 0.3s ease;
        display: flex;
        flex-direction: column;
    }
    
    .product-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 15px 30px rgba(0, 0, 0, 0.1);
    }
    
    .product-image {
        height: 200px;
        background-color: #ddd;
        background-size: cover;
        background-position: center;
    }
    
    .product-info {
        padding: 20px;
        flex-grow: 1;
        display: flex;
        flex-direction: column;
    }
    
    .product-info h3 {
        font-size: 1.3rem;
        margin-bottom: 10px;
        color: var(--dark-color);
    }
    
    .product-info p {
        color: #777;
        margin-bottom: 15px;
        flex-grow: 1;
    }
    
    .product-price {
        font-size: 1.2rem;
        font-weight: 700;
        color: var(--primary-color);
        margin-bottom: 15px;
    }
    
    .product-button {
        width: 100%;
        padding: 12px;
        background-color: var(--primary-color);
        color: white;
        border: none;
        border-radius: 5px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
    }
    
    .product-button:hover {
        background-color: var(--secondary-color);
    }
    
    /* Cart notification */
    .cart-notification {
        position: fixed;
        top: 20px;
        right: 20px;
        background-color: var(--success-color);
        color: white;
        padding: 15px 20px;
        border-radius: 5px;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        z-index: 1000;
        display: flex;
        align-items: center;
        gap: 10px;
        transform: translateX(150%);
        transition: transform 0.3s ease;
    }
    
    .cart-notification.show {
        transform: translateX(0);
    }
    
    /* Loading and error states */
    .loading-text, .no-products, .error-text {
        text-align: center;
        grid-column: 1 / -1;
        padding: 40px;
        font-size: 1.1rem;
        color: #777;
    }
    
    .error-text {
        color: var(--danger-color);
    }
    
    /* Categories filter */
    .categories-filter {
        display: flex;
        justify-content: center;
        flex-wrap: wrap;
        gap: 15px;
        margin-bottom: 40px;
    }
    
    .category-btn {
        padding: 10px 20px;
        background-color: white;
        border: 1px solid #ddd;
        border-radius: 50px;
        cursor: pointer;
        transition: all 0.3s ease;
    }
    
    .category-btn.active, .category-btn:hover {
        background-color: var(--primary-color);
        color: white;
        border-color: var(--primary-color);
    }
    
    /* Search section */
    .search-section {
        padding: 40px 0;
        background-color: var(--light-color);
    }
    
    .search-container {
        max-width: 600px;
        margin: 0 auto;
        position: relative;
    }
    
    .search-input {
        width: 100%;
        padding: 15px 20px;
        border-radius: 50px;
        border: 1px solid #ddd;
        font-size: 1rem;
        padding-right: 50px;
    }
    
    .search-button {
        position: absolute;
        right: 5px;
        top: 5px;
        background: var(--primary-color);
        border: none;
        color: white;
        width: 40px;
        height: 40px;
        border-radius: 50%;
        cursor: pointer;
    }
    
    /* Footer */
    footer {
        background-color: var(--dark-color);
        color: white;
        padding: 60px 0 20px;
    }
    
    .footer-content {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 40px;
        margin-bottom: 40px;
    }
    
    .footer-column h3 {
        font-size: 1.3rem;
        margin-bottom: 20px;
        color: var(--accent-color);
    }
    
    .footer-column ul {
        list-style: none;
    }
    
    .footer-column ul li {
        margin-bottom: 10px;
        display: flex;
        align-items: center;
        gap: 10px;
    }
    
    .footer-column a {
        color: #ddd;
        text-decoration: none;
        transition: all 0.3s ease;
    }
    
    .footer-column a:hover {
        color: var(--accent-color);
        padding-left: 5px;
    }
    
    .social-links {
        display: flex;
        gap: 15px;
        margin-top: 20px;
    }
    
    .social-links a {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        width: 40px;
        height: 40px;
        background-color: rgba(255, 255, 255, 0.1);
        border-radius: 50%;
        color: white;
        transition: all 0.3s ease;
    }
    
    .social-links a:hover {
        background-color: var(--primary-color);
        transform: translateY(-3px);
    }
    
    .copyright {
        text-align: center;
        padding-top: 20px;
        border-top: 1px solid rgba(255, 255, 255, 0.1);
        font-size: 0.9rem;
        color: #aaa;
    }
    
    /* Animations */
    @keyframes fadeIn {
        from { opacity: 0; }
        to { opacity: 1; }
    }
    
    @keyframes fadeInUp {
        from {
            opacity: 0;
            transform: translateY(20px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }
    
    @keyframes fadeInDown {
        from {
            opacity: 0;
            transform: translateY(-20px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }
    
    /* Responsive Design */
    @media (max-width: 992px) {
        .hero h2 {
            font-size: 2.5rem;
        }
    }
    
    @media (max-width: 768px) {
        .header-content {
            flex-wrap: wrap;
        }
        
        .menu-toggle {
            display: flex;
        }
        
        nav {
            width: 100%;
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
        }
        
        nav.active {
            max-height: 300px;
        }
        
        nav ul {
            flex-direction: column;
            padding: 20px 0;
            gap: 15px;
        }
        
        .auth-buttons {
            margin-left: auto;
        }
        
        .hero h2 {
            font-size: 2rem;
        }
        
        .hero p {
            font-size: 1rem;
        }
        
        .hero-buttons {
            flex-direction: column;
            align-items: center;
        }
        
        .section-title h2 {
            font-size: 2rem;
        }
        
        .feature-card, .product-card {
            padding: 20px;
        }
        
        .footer-content {
            grid-template-columns: 1fr;
            gap: 30px;
        }
    }
    
    @media (max-width: 576px) {
        .logo h1 {
            font-size: 1.5rem;
        }
        
        .auth-buttons {
            gap: 10px;
        }
        
        .btn {
            padding: 8px 15px;
            font-size: 0.9rem;
        }
        
        .hero {
            padding: 60px 0;
        }
        
        .hero h2 {
            font-size: 1.8rem;
        }
        
        .features, .products {
            padding: 50px 0;
        }
        
        .features-grid, .products-grid {
            grid-template-columns: 1fr;
        }
    }
    </style>
</head>
<body>
    <!-- Header -->
    <header>
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <i class="fas fa-code"></i>
                    <h1>Digital Code Store</h1>
                </div>
                
                <button class="menu-toggle" id="menu-toggle">
                    <span></span>
                    <span></span>
                    <span></span>
                </button>
                
                <nav id="main-nav">
                    <ul>
                        <li><a href="#">Trang chủ</a></li>
                        <li><a href="#products">Sản phẩm</a></li>
                        <li><a href="#contact">Liên hệ</a></li>
                    </ul>
                </nav>
                <div class="auth-buttons">
                    <button class="btn btn-outline" onclick="window.location.href='../login/index.html'">
                        <i class="fas fa-sign-in-alt"></i> Đăng nhập
                    </button>
                    <button class="btn btn-primary" onclick="window.location.href='../login/index.html#register'">
                        <i class="fas fa-user-plus"></i> Đăng ký
                    </button>
                </div>
            </div>
        </div>
    </header>

    <!-- Hero Section -->
    <section class="hero">
        <div class="container">
            <div class="hero-content">
                <h2>Digital Tools and Code Store</h2>
                <p>Nền tảng mua bán công cụ, mã nguồn và dịch vụ Facebook hàng đầu. Khám phá các giải pháp công nghệ giúp bạn phát triển kinh doanh và dự án cá nhân.</p>
                <div class="hero-buttons">
                    <button class="btn btn-primary" onclick="window.location.href='#products'">
                        <i class="fas fa-shopping-cart"></i> Mua ngay
                    </button>
                    <button class="btn btn-outline" onclick="window.location.href='#features'">
                        <i class="fas fa-info-circle"></i> Tìm hiểu thêm
                    </button>
                </div>
            </div>
        </div>
    </section>

    <!-- Search Section -->
    <section class="search-section">
        <div class="container">
            <div class="search-container">
                <input type="text" class="search-input" placeholder="Tìm kiếm sản phẩm..." id="search-input">
                <button class="search-button" id="search-button">
                    <i class="fas fa-search"></i>
                </button>
            </div>
        </div>
    </section>

    <!-- Features Section -->
    <section class="features" id="features">
        <div class="container">
            <div class="section-title">
                <h2>Tại sao chọn chúng tôi?</h2>
                <p>Digital Tools and Code Store mang đến cho bạn những trải nghiệm mua sắm công nghệ tuyệt vời nhất</p>
            </div>
            <div class="features-grid">
                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-shield-alt"></i>
                    </div>
                    <h3>Bảo mật tuyệt đối</h3>
                    <p>Tất cả giao dịch và thông tin khách hàng được mã hóa và bảo vệ an toàn</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-bolt"></i>
                    </div>
                    <h3>Giao hàng nhanh chóng</h3>
                    <p>Nhận sản phẩm ngay lập tức sau thanh toán thành công</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-headset"></i>
                    </div>
                    <h3>Hỗ trợ 24/7</h3>
                    <p>Đội ngũ hỗ trợ luôn sẵn sàng giải đáp mọi thắc mắc của bạn</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-sync-alt"></i>
                    </div>
                    <h3>Cập nhật thường xuyên</h3>
                    <p>Sản phẩm luôn được cập nhật phiên bản mới nhất và bảo trì định kỳ</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-graduation-cap"></i>
                    </div>
                    <h3>Hướng dẫn chi tiết</h3>
                    <p>Tài liệu hướng dẫn sử dụng chi tiết kèm theo mỗi sản phẩm</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-medal"></i>
                    </div>
                    <h3>Chất lượng đảm bảo</h3>
                    <p>Cam kết hoàn tiền nếu sản phẩm không hoạt động như mô tả</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Products Section -->
    <section class="products" id="products">
        <div class="container">
            <div class="section-title">
                <h2>Sản phẩm nổi bật</h2>
                <p>Khám phá các công cụ, mã nguồn và dịch vụ Facebook được ưa chuộng nhất</p>
            </div>
            
            <div class="categories-filter" id="categories-filter">
                <button class="category-btn active" data-category="all">Tất cả</button>
                <button class="category-btn" data-category="tool">Công cụ Facebook</button>
                <button class="category-btn" data-category="code">Mã nguồn Website</button>
                <button class="category-btn" data-category="service">Dịch vụ</button>
            </div>
            
            <div class="products-grid" id="products-container">
                <!-- Sản phẩm sẽ được tải động từ Firebase -->
                <p class="loading-text">Đang tải sản phẩm...</p>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer id="contact">
        <div class="container">
            <div class="footer-content">
                <div class="footer-column">
                    <h3>Về chúng tôi</h3>
                    <p>Digital Tools and Code Store là nền tảng cung cấp công cụ, mã nguồn và dịch vụ Facebook chất lượng cao với hơn 5 năm kinh nghiệm.</p>
                    <div class="social-links">
                        <a href="#"><i class="fab fa-facebook-f"></i></a>
                        <a href="#"><i class="fab fa-twitter"></i></a>
                        <a href="#"><i class="fab fa-instagram"></i></a>
                        <a href="#"><i class="fab fa-youtube"></i></a>
                    </div>
                </div>
                <div class="footer-column">
                    <h3>Thông tin liên hệ</h3>
                    <ul>
                        <li><i class="fas fa-map-marker-alt"></i> 123 Đường Digital, Quận 1, TP.HCM</li>
                        <li><i class="fas fa-phone"></i> (028) 3456 7890</li>
                        <li><i class="fas fa-envelope"></i> support@digitalcodestore.com</li>
                        <li><i class="fas fa-clock"></i> Thứ 2 - Thứ 7: 8:00 - 22:00</li>
                    </ul>
                </div>
                <div class="footer-column">
                    <h3>Chính sách</h3>
                    <ul>
                        <li><a href="#">Chính sách bảo mật</a></li>
                        <li><a href="#">Điều khoản sử dụng</a></li>
                        <li><a href="#">Chính sách hoàn tiền</a></li>
                        <li><a href="#">Phương thức thanh toán</a></li>
                    </ul>
                </div>
                <div class="footer-column">
                    <h3>Đăng ký nhận tin</h3>
                    <p>Nhận thông báo về sản phẩm mới và khuyến mãi đặc biệt</p>
                    <div class="search-container">
                        <input type="email" class="search-input" placeholder="Email của bạn..." id="newsletter-email">
                        <button class="search-button" id="newsletter-button">
                            <i class="fas fa-paper-plane"></i>
                        </button>
                    </div>
                </div>
            </div>
            <div class="copyright">
                <p>&copy; 2023 Digital Tools and Code Store. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <!-- Cart Notification -->
    <div class="cart-notification" id="cart-notification">
        <i class="fas fa-check-circle"></i>
        <span>Đã thêm vào giỏ hàng!</span>
    </div>

    <!-- Firebase App (core functionality) -->
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <!-- Firebase Authentication -->
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
    <!-- Firebase Firestore -->
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>

    <script>
        // Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyA7kY_xl-B1r6pfRlUCVcI8OcLe7rOh11g",
            authDomain: "digitalcodestore-tuquangnam.firebaseapp.com",
            projectId: "digitalcodestore-tuquangnam",
            storageBucket: "digitalcodestore-tuquangnam.firebasestorage.app",
            messagingSenderId: "226534281162",
            appId: "1:226534281162:web:9e734c1b07378efb280933",
            measurementId: "G-9V4G42XSZS"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();
        
        // Check authentication state
        auth.onAuthStateChanged((user) => {
            if (user) {
                // User is signed in
                console.log("User is signed in:", user.email);
                // Update auth buttons
                const authButtons = document.querySelector('.auth-buttons');
                authButtons.innerHTML = `
                    <button class="btn btn-outline" onclick="firebase.auth().signOut()">
                        <i class="fas fa-sign-out-alt"></i> Đăng xuất
                    </button>
                    <button class="btn btn-primary" onclick="window.location.href='../profile/index.html'">
                        <i class="fas fa-user"></i> ${user.email}
                    </button>
                `;
            } else {
                // User is signed out
                console.log("User is signed out");
            }
        });

        // Mobile menu toggle
        document.getElementById('menu-toggle').addEventListener('click', function() {
            document.getElementById('main-nav').classList.toggle('active');
        });

        // Hàm tải sản phẩm từ Firestore
        function loadProducts(category = 'all') {
            const productsGrid = document.getElementById('products-container');
            if (!productsGrid) return;
            
            productsGrid.innerHTML = '<p class="loading-text">Đang tải sản phẩm...</p>';
            
            let productsQuery = db.collection('products').where('status', '==', 'active');
            
            if (category !== 'all') {
                productsQuery = productsQuery.where('category', '==', category);
            }
            
            productsQuery.get()
                .then((querySnapshot) => {
                    productsGrid.innerHTML = '';
                    
                    if (querySnapshot.empty) {
                        productsGrid.innerHTML = '<p class="no-products">Chưa có sản phẩm nào.</p>';
                        return;
                    }
                    
                    querySnapshot.forEach((doc) => {
                        const product = doc.data();
                        const productId = doc.id;
                        
                        const productCard = `
                            <div class="product-card" data-category="${product.category || 'tool'}">
                                <div class="product-image" style="background-image: url('${product.imageUrl || 'https://images.unsplash.com/photo-1542831371-29b0f74f9713?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=80'}')"></div>
                                <div class="product-info">
                                    <h3>${product.name}</h3>
                                    <p>${product.description}</p>
                                    <div class="product-price">${formatPrice(product.price)}</div>
                                    <button class="product-button" onclick="addToCart('${productId}')">
                                        <i class="fas fa-cart-plus"></i> Thêm vào giỏ
                                    </button>
                                </div>
                            </div>
                        `;
                        
                        productsGrid.innerHTML += productCard;
                    });
                })
                .catch((error) => {
                    productsGrid.innerHTML = '<p class="error-text">Có lỗi xảy ra khi tải sản phẩm.</p>';
                    console.error("Error loading products: ", error);
                });
        }

        // Hàm định dạng giá tiền
        function formatPrice(price) {
            if (!price) return '0 ₫';
            return new Intl.NumberFormat('vi-VN', { style: 'currency', currency: 'VND' }).format(price);
        }

        // Hàm thêm vào giỏ hàng
        function addToCart(productId) {
            // Hiển thị thông báo
            const notification = document.getElementById('cart-notification');
            notification.classList.add('show');
            
            // Ẩn thông báo sau 3 giây
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
            
            // Lưu vào localStorage (tạm thời)
            let cart = JSON.parse(localStorage.getItem('cart')) || [];
            
            // Kiểm tra xem sản phẩm đã có trong giỏ chưa
            const existingItem = cart.find(item => item.id === productId);
            
            if (existingItem) {
                existingItem.quantity += 1;
            } else {
                cart.push({
                    id: productId,
                    quantity: 1,
                    addedAt: new Date().getTime()
                });
            }
            
            localStorage.setItem('cart', JSON.stringify(cart));
        }

        // Lọc sản phẩm theo danh mục
        function setupCategoryFilters() {
            const categoryButtons = document.querySelectorAll('.category-btn');
            
            categoryButtons.forEach(button => {
                button.addEventListener('click', function() {
                    // Xóa class active từ tất cả các nút
                    categoryButtons.forEach(btn => btn.classList.remove('active'));
                    
                    // Thêm class active cho nút được click
                    this.classList.add('active');
                    
                    // Lọc sản phẩm theo danh mục
                    const category = this.getAttribute('data-category');
                    loadProducts(category);
                });
            });
        }

        // Tìm kiếm sản phẩm
        function setupSearch() {
            const searchInput = document.getElementById('search-input');
            const searchButton = document.getElementById('search-button');
            
            const performSearch = () => {
                const searchTerm = searchInput.value.trim().toLowerCase();
                
                if (searchTerm) {
                    const productsGrid = document.getElementById('products-container');
                    productsGrid.innerHTML = '<p class="loading-text">Đang tìm kiếm...</p>';
                    
                    db.collection('products')
                        .where('status', '==', 'active')
                        .get()
                        .then((querySnapshot) => {
                            productsGrid.innerHTML = '';
                            let foundProducts = false;
                            
                            querySnapshot.forEach((doc) => {
                                const product = doc.data();
                                const productId = doc.id;
                                
                                // Tìm kiếm theo tên và mô tả
                                if (product.name.toLowerCase().includes(searchTerm) || 
                                    product.description.toLowerCase().includes(searchTerm)) {
                                    foundProducts = true;
                                    
                                    const productCard = `
                                        <div class="product-card" data-category="${product.category || 'tool'}">
                                            <div class="product-image" style="background-image: url('${product.imageUrl || 'https://images.unsplash.com/photo-1542831371-29b0f74f9713?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=80'}')"></div>
                                            <div class="product-info">
                                                <h3>${product.name}</h3>
                                                <p>${product.description}</p>
                                                <div class="product-price">${formatPrice(product.price)}</div>
                                                <button class="product-button" onclick="addToCart('${productId}')">
                                                    <i class="fas fa-cart-plus"></i> Thêm vào giỏ
                                                </button>
                                            </div>
                                        </div>
                                    `;
                                    
                                    productsGrid.innerHTML += productCard;
                                }
                            });
                            
                            if (!foundProducts) {
                                productsGrid.innerHTML = '<p class="no-products">Không tìm thấy sản phẩm phù hợp.</p>';
                            }
                        })
                        .catch((error) => {
                            productsGrid.innerHTML = '<p class="error-text">Có lỗi xảy ra khi tìm kiếm.</p>';
                            console.error("Error searching products: ", error);
                        });
                }
            };
            
            searchButton.addEventListener('click', performSearch);
            searchInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    performSearch();
                }
            });
        }

        // Đăng ký nhận tin
        function setupNewsletter() {
            const newsletterButton = document.getElementById('newsletter-button');
            
            newsletterButton.addEventListener('click', function() {
                const emailInput = document.getElementById('newsletter-email');
                const email = emailInput.value.trim();
                
                if (email) {
                    // Lưu email vào Firestore
                    db.collection('newsletter').add({
                        email: email,
                        subscribedAt: new Date()
                    })
                    .then(() => {
                        alert('Cảm ơn bạn đã đăng ký nhận tin!');
                        emailInput.value = '';
                    })
                    .catch((error) => {
                        console.error("Error saving email: ", error);
                        alert('Có lỗi xảy ra, vui lòng thử lại sau.');
                    });
                } else {
                    alert('Vui lòng nhập địa chỉ email.');
                }
            });
        }

        // Gọi hàm khi trang load
        document.addEventListener('DOMContentLoaded', function() {
            // Tải sản phẩm
            loadProducts();
            
            // Thiết lập bộ lọc danh mục
            setupCategoryFilters();
            
            // Thiết lập tìm kiếm
            setupSearch();
            
            // Thiết lập newsletter
            setupNewsletter();
        });
    </script>
</body>
</html>